import{r as n,o as L,w as T,c as s,a as t,b as k,d as $,T as q,e as b,f as o,t as w,g as I,F as N,h as V,u as M,i as y,n as B,j as h,k as P,l as R,m as C,v as A,p as U,q as D}from"./userAuth-Bzkke8O3.js";import{u as E,c as Q,a as F}from"./vue-router-CGpQckM_.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"container mx-auto px-4 py-8 animate-fade-in"},Y={key:0,class:"text-center text-gray-500 py-12 animate-pulse"},G={key:1},W={key:0},J={key:0,class:"text-center text-gray-500 text-lg animate-pulse"},K={key:1,class:"text-center text-red-500 text-lg animate-shake"},X={key:2,class:"grid sm:grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-6"},Z={class:"text-2xl font-bold text-green-700 mb-2"},ee={class:"text-green-600 mb-4"},te=["onClick"],ae={key:1,class:"text-center text-red-500 py-12 text-lg animate-bounce"},se={__name:"Home",setup(g){E();const i=n(null),l=n(localStorage.getItem("auth_token")),u=n(!0),c=n(!1),d=n([]),f=n(!1),m=n(null);function v(r){r?b.defaults.headers.common.Authorization=`Bearer ${r}`:delete b.defaults.headers.common.Authorization}v(l.value);async function x(){var r,e;try{const a=await b.get("/api/me");i.value=a.data;const z=((e=(r=i.value)==null?void 0:r.roles)==null?void 0:e.map(H=>H.name))||[];c.value=z.includes("super-admin")||z.includes("student")}catch{i.value=null,l.value=null,localStorage.removeItem("auth_token"),v(null),m.value="Your session has expired. Please log in again.",c.value=!1}}async function p(){var r;f.value=!0;try{const e=await b.get("/api/student/display");d.value=((r=e.data)==null?void 0:r.data)??e.data}catch{m.value="❌ Failed to load quizzes."}finally{f.value=!1}}function _(r){window.location.href=`/questions/${r}`}return L(async()=>{if(!l.value){u.value=!1;return}await x(),c.value&&await p(),u.value=!1}),T(async()=>{l.value?(localStorage.setItem("auth_token",l.value),v(l.value),await x(),c.value&&await p()):(i.value=null,c.value=!1,d.value=[],localStorage.removeItem("auth_token"),v(null))}),(r,e)=>(o(),s("div",O,[u.value?(o(),s("div",Y,e[0]||(e[0]=[t("p",{class:"text-xl font-medium"},"🔄 Checking user status...",-1)]))):(o(),s("div",G,[k(q,{name:"fade",mode:"out-in"},{default:$(()=>[c.value?(o(),s("div",W,[e[1]||(e[1]=t("h1",{class:"text-4xl font-extrabold text-center text-green-700 mb-10 animate-slide-down"}," Available Quizzes ",-1)),f.value?(o(),s("div",J," 🔄 Loading quizzes... ")):m.value?(o(),s("div",K,w(m.value),1)):(o(),s("div",X,[k(I,{name:"fade",tag:"div",class:"contents"},{default:$(()=>[(o(!0),s(N,null,V(d.value,a=>(o(),s("div",{key:a.id,class:"bg-white border border-green-200 rounded-2xl p-6 shadow-md hover:shadow-xl transition-all duration-300 animate-fade-in hover:-translate-y-1"},[t("h2",Z,w(a.title),1),t("p",ee," Duration: "+w(a.duration??"Not specified")+" mins ",1),t("button",{onClick:z=>_(a.id),class:"w-full bg-gradient-to-r from-green-500 to-green-700 text-white px-4 py-2 rounded-full font-semibold shadow hover:opacity-90 transition-all duration-300"}," Start Now ",8,te)]))),128))]),_:1})]))])):(o(),s("div",ae," 🚫 You are not authorized to view quizzes. "))]),_:1})]))]))}},oe=S(se,[["__scopeId","data-v-a005b73d"]]),ne={class:"bg-green-700 text-white shadow-md sticky top-0 z-50 rounded-lg"},le={class:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between"},re={key:0,class:"relative ml-4"},ie={key:0,class:"absolute right-0 mt-2 w-64 max-w-[90vw] bg-white z-10 text-green-700 rounded-xl shadow-xl py-3 px-2 animate-fade-in"},ue={key:1,class:"hidden md:flex items-center gap-3"},de={key:0,class:"md:hidden px-4 pb-4"},ce={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},fe={class:"bg-white p-6 rounded shadow-lg w-80"},me={key:0,class:"text-red-500 text-sm mt-2"},ve={__name:"Header",setup(g){const{user:i,login:l,logout:u,init:c}=M(),d=n(!1),f=n(!1),m=n(!1),v=n(""),x=n(""),p=n(null);L(async()=>{await c()});async function _(){p.value=null,await l(v.value,x.value),i.value?d.value=!1:p.value="Login failed"}return(r,e)=>(o(),s("header",ne,[t("div",le,[e[12]||(e[12]=t("div",{class:"text-2xl font-extrabold tracking-wide"},"QuizzApp",-1)),t("button",{onClick:e[0]||(e[0]=a=>m.value=!m.value),class:"md:hidden focus:outline-none"},e[8]||(e[8]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])),t("nav",{class:B(["md:flex gap-6 items-center",m.value?"flex flex-col absolute top-full rounded-lg mt-1 left-0 w-full bg-green-700 p-4":"hidden md:flex"])},e[9]||(e[9]=[t("a",{href:"/",class:"text-white hover:text-green-100 font-medium"},"Home",-1),t("a",{href:"/projects",class:"text-white hover:text-green-100 font-medium"},"My Projects",-1),t("a",{href:"/tests",class:"text-white hover:text-green-100 font-medium"},"Quizzes",-1)]),2),h(i)?(o(),s("div",re,[t("button",{onClick:e[1]||(e[1]=a=>f.value=!f.value),class:"flex items-center gap-2 bg-white text-green-700 font-semibold px-4 py-1 rounded-full shadow-sm hover:bg-gray-100"},[t("span",null,w(h(i).name),1)]),f.value?(o(),s("div",ie,[e[10]||(e[10]=P('<a href="/profile" class="block px-4 py-2 rounded hover:bg-green-50" data-v-06a8670f>Profile</a><a href="/my-projects" class="block px-4 py-2 rounded hover:bg-green-50" data-v-06a8670f>My Projects</a><a href="/settings" class="block px-4 py-2 rounded hover:bg-green-50" data-v-06a8670f>Settings</a><a href="/admin/dashboard" class="block px-4 py-2 rounded hover:bg-green-50" data-v-06a8670f>Admin Dashboard</a><hr class="my-2" data-v-06a8670f>',5)),t("button",{onClick:e[2]||(e[2]=(...a)=>h(u)&&h(u)(...a)),class:"w-full text-left px-4 py-2 text-red-600 rounded hover:bg-red-50"},"Logout")])):y("",!0)])):(o(),s("div",ue,[t("button",{onClick:e[3]||(e[3]=a=>d.value=!0),class:"bg-white text-green-700 px-4 py-1 rounded-full font-medium hover:bg-gray-100"},"Login"),e[11]||(e[11]=t("a",{href:"/register",class:"text-white underline"},"Register",-1))]))]),!h(i)&&m.value?(o(),s("div",de,[t("button",{onClick:e[4]||(e[4]=a=>d.value=!0),class:"block w-full text-left text-white font-medium py-2"},"Login"),e[13]||(e[13]=t("a",{href:"/register",class:"block w-full text-left text-white font-medium py-2"},"Register",-1))])):y("",!0),d.value?(o(),s("div",ce,[t("div",fe,[e[15]||(e[15]=t("h2",{class:"text-lg font-bold mb-4 text-green-800"},"Login",-1)),t("form",{onSubmit:R(_,["prevent"])},[C(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>v.value=a),type:"email",placeholder:"Email",class:"border border-green-300 p-2 w-full mb-2 rounded"},null,512),[[A,v.value]]),C(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>x.value=a),type:"password",placeholder:"Password",class:"border border-green-300 p-2 w-full mb-4 rounded"},null,512),[[A,x.value]]),e[14]||(e[14]=t("button",{class:"bg-green-700 text-white px-4 py-2 rounded w-full"},"Login",-1)),t("button",{onClick:e[7]||(e[7]=a=>d.value=!1),type:"button",class:"text-gray-500 text-sm mt-2 w-full"},"Cancel")],32),p.value?(o(),s("p",me,w(p.value),1)):y("",!0)])])):y("",!0)]))}},pe=S(ve,[["__scopeId","data-v-06a8670f"]]),ge={class:"p-6 text-center"},xe={__name:"App",setup(g){return n(0),(i,l)=>{const u=U("router-view");return o(),s("div",ge,[k(pe),k(u)])}}},he=[{path:"/",name:"home",component:oe}],j=Q({history:F(),routes:he});j.beforeEach(async(g,i,l)=>{const{token:u,user:c,init:d,hasAnyRole:f}=M();if(u.value&&!c.value&&await d(),g.meta.requiresAuth){if(!u.value)return l("/login");if(g.meta.roles&&!f(g.meta.roles))return l("/")}l()});D(xe).use(j).mount("#app");
