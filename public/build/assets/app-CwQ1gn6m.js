const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QuizPage-GAPK9QF8.js","assets/_plugin-vue_export-helper-DlAUqK2U.js"])))=>i.map(i=>d[i]);
import{r as d,a as k,o as L,c as a,b as t,d as b,w as $,T as P,e as l,t as y,f as S,F as T,g as U,u as A,h as _,n as B,i as w,j as H,k as z,v as C,l as R,m as V}from"./userAuth-Bw2eZrmN.js";import"./axios-ty6bbf6K.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as M,c as F,a as I}from"./vue-router-DJDVh-I8.js";const O={class:"container mx-auto px-4 py-8 animate-fade-in"},D={key:0,class:"text-center text-gray-500 py-12 animate-pulse"},N={key:1},Q={key:0},W={key:0,class:"text-center text-gray-500 text-lg animate-pulse"},G={key:1,class:"text-center text-red-500 text-lg animate-shake"},Y={key:2,class:"flex flex-wrap gap-6 justify-center"},J={class:"text-2xl font-bold text-gray-800 mb-2"},K={class:"text-gray-600 mb-4"},X=["onClick"],Z={key:1,class:"text-center text-red-500 py-12 text-lg animate-bounce"},ee={__name:"Home",setup(x){M();const p=d(null),r=localStorage.getItem("auth_token"),c=d(!0),v=d(!1),f=d([]),s=d(!1),n=d(null);r&&(k.defaults.headers.common.Authorization=`Bearer ${r}`);async function i(){const o=await k.get("/api/me");p.value=o.data}async function g(){var o;s.value=!0;try{const u=await k.get("/api/student/display");f.value=((o=u.data)==null?void 0:o.data)??u.data}catch{n.value="❌ Failed to load quizzes."}finally{s.value=!1}}function h(o){window.location.href=`/questions/${o}`}return L(async()=>{var o,u;if(!r){console.warn("🔒 No token found"),c.value=!1;return}try{await i();const e=((u=(o=p.value)==null?void 0:o.roles)==null?void 0:u.map(m=>m.name))||[];v.value=e.includes("super-admin")||e.includes("student"),v.value&&await g()}catch(e){console.error("❌ Failed to fetch user or tests:",e)}finally{c.value=!1}}),(o,u)=>(l(),a("div",O,[c.value?(l(),a("div",D,u[0]||(u[0]=[t("p",{class:"text-xl font-medium"},"🔄 Checking user status...",-1)]))):(l(),a("div",N,[b(P,{name:"fade",mode:"out-in"},{default:$(()=>[v.value?(l(),a("div",Q,[u[1]||(u[1]=t("h1",{class:"text-4xl font-extrabold text-center text-green-700 mb-10 animate-slide-down"}," 🧠 Available Quizzes ",-1)),s.value?(l(),a("div",W," 🔄 Loading quizzes... ")):n.value?(l(),a("div",G,y(n.value),1)):(l(),a("div",Y,[b(S,{name:"fade",tag:"div",class:"flex flex-wrap gap-6 justify-center w-full"},{default:$(()=>[(l(!0),a(T,null,U(f.value,e=>(l(),a("div",{key:e.id,class:"w-full sm:w-[90%] md:w-[30%] xl:w-[22%] border rounded-2xl p-6 bg-white shadow-md hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 animate-fade-in"},[t("h2",J,y(e.title),1),t("p",K," مدة الاختبار: "+y(e.duration??"غير محددة")+" دقيقة ",1),t("button",{onClick:m=>h(e.id),class:"w-full bg-green-600 from-green-500 to-green-700 text-white px-4 py-2 rounded-full font-semibold shadow hover:opacity-90 transition-all duration-300"}," ابدأ الآن ",8,X)]))),128))]),_:1})]))])):(l(),a("div",Z," 🚫 You are not authorized to view quizzes. "))]),_:1})]))]))}},te=j(ee,[["__scopeId","data-v-534a4f32"]]),se={class:"bg-green-700 text-white p-4 flex justify-between items-center relative"},oe={key:0,class:"relative ml-4"},ne={class:"font-semibold"},ae={key:0,class:"absolute right-0 mt-2 w-48 bg-white text-gray-800 rounded shadow z-50 animate-fade-in"},le={key:1,class:"flex items-center space-x-3 text-sm"},re={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ie={class:"bg-white p-6 rounded shadow-lg w-96"},ue={key:0,class:"text-red-500 text-sm mt-2"},de={__name:"Header",setup(x){const{user:p,login:r,logout:c,init:v}=A(),f=d(!1),s=d(!1),n=d(!1),i=d(""),g=d(""),h=d(null);L(async()=>{await v()});async function o(){h.value=null,await r(i.value,g.value),p.value?f.value=!1:h.value="Login failed"}return(u,e)=>(l(),a("header",se,[e[18]||(e[18]=t("div",{class:"text-xl font-bold"},"🚀 MyApp",-1)),t("button",{onClick:e[0]||(e[0]=m=>n.value=!n.value),class:"md:hidden text-white focus:outline-none"},e[7]||(e[7]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])),t("nav",{class:B(["flex-col md:flex-row md:flex items-center absolute md:static top-full left-0 w-full md:w-auto bg-green-700 md:bg-transparent z-40 transition-all",n.value?"flex":"hidden"])},e[8]||(e[8]=[t("ul",{class:"flex flex-col md:flex-row md:space-x-6 w-full md:w-auto text-sm"},[t("li",null,[t("a",{href:"/",class:"block px-4 py-2 hover:bg-green-600 md:hover:bg-transparent"},"🏠 Home")]),t("li",null,[t("a",{href:"/projects",class:"block px-4 py-2 hover:bg-green-600 md:hover:bg-transparent"},"📁 Projects")])],-1)]),2),w(p)?(l(),a("div",oe,[t("button",{onClick:e[1]||(e[1]=m=>s.value=!s.value),class:"flex items-center space-x-2 hover:underline"},[t("span",ne,y(w(p).name),1),e[9]||(e[9]=t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414L10 13.414l-4.707-4.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))]),s.value?(l(),a("div",ae,[e[10]||(e[10]=t("a",{href:"/profile",class:"block px-4 py-2 hover:bg-gray-100"},"👤 الملف الشخصي",-1)),e[11]||(e[11]=t("a",{href:"/my-projects",class:"block px-4 py-2 hover:bg-gray-100"},"📁 مشاريعي الخاصة",-1)),e[12]||(e[12]=t("a",{href:"/settings",class:"block px-4 py-2 hover:bg-gray-100"},"⚙️ الإعدادات",-1)),e[13]||(e[13]=t("a",{href:"/admin/dashboard",class:"block px-4 py-2 hover:bg-gray-100"},"🛠 لوحة التحكم",-1)),e[14]||(e[14]=t("hr",null,null,-1)),t("button",{onClick:e[2]||(e[2]=(...m)=>w(c)&&w(c)(...m)),class:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50"},"🚪 Logout")])):_("",!0)])):(l(),a("div",le,[t("button",{onClick:e[3]||(e[3]=m=>f.value=!0),class:"hover:underline"},"Login"),e[15]||(e[15]=t("a",{href:"/register",class:"hover:underline"},"Register",-1))])),f.value?(l(),a("div",re,[t("div",ie,[e[17]||(e[17]=t("h2",{class:"text-lg font-bold mb-4 text-gray-800"},"Login",-1)),t("form",{onSubmit:H(o,["prevent"])},[z(t("input",{"onUpdate:modelValue":e[4]||(e[4]=m=>i.value=m),type:"email",placeholder:"Email",class:"border p-2 w-full mb-2"},null,512),[[C,i.value]]),z(t("input",{"onUpdate:modelValue":e[5]||(e[5]=m=>g.value=m),type:"password",placeholder:"Password",class:"border p-2 w-full mb-4"},null,512),[[C,g.value]]),e[16]||(e[16]=t("button",{class:"bg-green-600 text-white px-4 py-2 rounded w-full"},"Login",-1)),t("button",{onClick:e[6]||(e[6]=m=>f.value=!1),type:"button",class:"text-gray-500 text-sm mt-2 w-full"},"Cancel")],32),h.value?(l(),a("p",ue,y(h.value),1)):_("",!0)])])):_("",!0)]))}},ce=j(de,[["__scopeId","data-v-15aeb822"]]),fe={class:"p-6 text-center"},me={__name:"App",setup(x){return d(0),(p,r)=>{const c=R("router-view");return l(),a("div",fe,[b(ce),b(c)])}}},pe="modulepreload",ve=function(x){return"/build/"+x},E={},ge=function(p,r,c){let v=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),n=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));v=Promise.allSettled(r.map(i=>{if(i=ve(i),i in E)return;E[i]=!0;const g=i.endsWith(".css"),h=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${h}`))return;const o=document.createElement("link");if(o.rel=g?"stylesheet":pe,g||(o.as="script"),o.crossOrigin="",o.href=i,n&&o.setAttribute("nonce",n),document.head.appendChild(o),g)return new Promise((u,e)=>{o.addEventListener("load",u),o.addEventListener("error",()=>e(new Error(`Unable to preload CSS for ${i}`)))})}))}function f(s){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=s,window.dispatchEvent(n),!n.defaultPrevented)throw s}return v.then(s=>{for(const n of s||[])n.status==="rejected"&&f(n.reason);return p().catch(f)})},xe=[{path:"/",name:"home",component:te},{path:"/questions",name:"quiz",component:()=>ge(()=>import("./QuizPage-GAPK9QF8.js"),__vite__mapDeps([0,1])),meta:{requiresAuth:!0,roles:["student"]}}],q=F({history:I(),routes:xe});q.beforeEach(async(x,p,r)=>{const{token:c,user:v,init:f,hasAnyRole:s}=A();if(c.value&&!v.value&&await f(),x.meta.requiresAuth){if(!c.value)return r("/login");if(x.meta.roles&&!s(x.meta.roles))return r("/")}r()});V(me).use(q).mount("#app");
