import{r as g,o as O,E as fe,i as ie,c as o,a as n,b as e,d as F,g as K,j as r,e as c,z as v,m as P,F as q,y as be,t as C,s as D,G as ye,n as W,h as S,H as G,q as H,v as V,u as ue,C as we,x as _e}from"./userAuth-CYnRtAl8.js";import{c as j,S as Z,C as ne,F as ce}from"./settings-BeFHjdOE.js";import{c as ke,a as $e}from"./axios-NFW_rT_G.js";/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=j("arrow-up-to-line",[["path",{d:"M5 3h14",key:"7usisc"}],["path",{d:"m18 13-6-6-6 6",key:"1kf1n9"}],["path",{d:"M12 7v14",key:"1akyts"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=j("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=j("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=j("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=j("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=j("moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=j("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=j("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=j("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=j("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=j("trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=j("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);/**
 * @license lucide-vue-next v0.519.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=j("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),De={class:"bg-green-700 text-white w-full px-4 py-3 flex items-center justify-between shadow-md"},Fe={class:"flex flex-wrap justify-center items-center gap-2"},Ve={href:"/",class:"bg-white text-green-700 px-3 py-1.5 rounded-full hover:bg-green-100"},qe={class:"bg-white text-green-700 px-3 py-1.5 rounded-full hover:bg-green-100"},je={class:"bg-white text-green-700 px-3 py-1.5 rounded-full hover:bg-green-100"},Qe={class:"bg-white text-green-700 px-3 py-1.5 rounded-full hover:bg-green-100"},Ee={class:"bg-white text-green-700 px-3 py-1.5 rounded-full hover:bg-green-100"},He={key:0,class:"absolute top-10 left-0 bg-white text-green-700 p-2 rounded-md shadow-lg space-y-1"},Re={class:"flex items-center gap-2 hover:text-green-800"},ze={class:"flex items-center gap-2 hover:text-green-800"},Ie={class:"text-lg font-bold mb-4 flex items-center gap-2"},Ne={class:"space-y-2"},Be={class:"text-lg font-bold mb-4 flex items-center gap-2"},Le={__name:"Header",setup(R){const f=g(!1),b=g(!1),i=g(!1),x=g(null),k=g(null),_=g(null);function p(){f.value=!1,b.value=!1,i.value=!1}function M(A){const a=x.value,y=k.value,t=_.value;(f.value&&a&&!a.contains(A.target)||b.value&&y&&!y.contains(A.target)||i.value&&t&&!t.contains(A.target))&&p()}return O(()=>{document.addEventListener("click",M)}),fe(()=>{document.removeEventListener("click",M)}),(A,a)=>{const y=ie("router-link");return n(),o(q,null,[e("header",De,[e("button",{onClick:a[0]||(a[0]=K(t=>b.value=!b.value,["stop"])),class:"p-2 rounded-full hover:bg-green-800"},[r(c(Z),{class:"w-6 h-6"})]),e("nav",Fe,[e("a",Ve,[r(c(re),{class:"w-5 h-5"})]),e("button",qe,[r(c(ne),{class:"w-5 h-5"})]),e("button",je,[r(c(J),{class:"w-5 h-5"})]),e("button",Qe,[r(c(Z),{class:"w-5 h-5"})]),e("button",Ee,[r(c(de),{class:"w-5 h-5"})]),e("div",{class:"relative md:hidden",ref_key:"moreRef",ref:_},[e("button",{onClick:a[1]||(a[1]=K(t=>i.value=!i.value,["stop"])),class:"bg-green-600 text-white px-3 py-1.5 rounded-full hover:bg-green-700"}," ⋯ "),i.value?(n(),o("div",He,[e("button",Re,[r(c(Me),{class:"w-4 h-4"}),a[3]||(a[3]=v(" More 1 "))]),e("button",ze,[r(c(ce),{class:"w-4 h-4"}),a[4]||(a[4]=v(" More 2 "))])])):F("",!0)],512)]),e("button",{onClick:a[2]||(a[2]=K(t=>f.value=!f.value,["stop"])),class:"p-2 rounded-full hover:bg-green-800"},[r(c(ae),{class:"w-6 h-6"})])]),f.value?(n(),o("div",{key:0,ref_key:"sidebarRef",ref:x,class:"fixed top-0 right-0 h-full w-64 bg-green-700 text-white shadow-lg z-50 p-4"},[e("h2",Ie,[r(c(ae),{class:"w-5 h-5"}),a[5]||(a[5]=v(" Menu"))]),e("ul",Ne,[e("li",null,[r(y,{to:"/admin/dashboard",class:"flex items-center gap-2 hover:text-white",onClick:p},{default:P(()=>[r(c(re),{class:"w-4 h-4"}),a[6]||(a[6]=v(" Dashboard "))]),_:1,__:[6]})]),e("li",null,[r(y,{to:"/admin/dashboard/questions",class:"flex items-center gap-2 hover:text-white",onClick:p},{default:P(()=>[r(c(ne),{class:"w-4 h-4"}),a[7]||(a[7]=v(" Questions "))]),_:1,__:[7]})]),e("li",null,[r(y,{to:"/admin/dashboard/sections",class:"flex items-center gap-2 hover:text-white",onClick:p},{default:P(()=>[r(c(J),{class:"w-4 h-4"}),a[8]||(a[8]=v(" Sections "))]),_:1,__:[8]})]),e("li",null,[r(y,{to:"/admin/dashboard/users",class:"flex items-center gap-2 hover:text-white",onClick:p},{default:P(()=>[r(c(de),{class:"w-4 h-4"}),a[9]||(a[9]=v(" Users "))]),_:1,__:[9]})]),e("li",null,[r(y,{to:"/admin/dashboard/settings",class:"flex items-center gap-2 hover:text-white",onClick:p},{default:P(()=>[r(c(Z),{class:"w-4 h-4"}),a[10]||(a[10]=v(" Settings "))]),_:1,__:[10]})])]),e("button",{onClick:p,class:"mt-4 text-sm text-white hover:underline"},"Close")],512)):F("",!0),b.value?(n(),o("div",{key:1,ref_key:"settingsRef",ref:k,class:"fixed top-0 left-0 h-full w-64 bg-green-700 text-white shadow-lg z-50 p-4"},[e("h2",Be,[r(c(Z),{class:"w-5 h-5"}),a[11]||(a[11]=v(" Settings"))]),a[12]||(a[12]=e("ul",{class:"space-y-2"},[e("li",null,[e("label",null,[e("input",{type:"checkbox",class:"mr-2"}),v(" Dark Mode")])]),e("li",null,[e("label",null,[e("input",{type:"checkbox",class:"mr-2"}),v(" English")])])],-1)),e("button",{onClick:p,class:"mt-4 text-sm text-white hover:underline"},"Close")],512)):F("",!0)],64)}}},Oe={class:"min-h-screen bg-gray-100 text-black"},Pe=be({__name:"App",setup(R){return(f,b)=>{const i=ie("router-view");return n(),o("div",Oe,[r(Le),r(i)])}}}),Ze={class:"max-w-7xl mx-auto p-6 space-y-8 text-green-700"},Ge={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},We={class:"bg-white border-2 border-green-500 rounded-2xl shadow p-6 text-center"},Je={class:"text-3xl font-bold text-green-700"},Ke={class:"bg-white border-2 border-green-500 rounded-2xl shadow p-6 text-center"},Xe={class:"text-3xl font-bold text-green-700"},Ye={class:"bg-white border-2 border-green-500 rounded-2xl shadow p-6 text-center"},et={class:"text-3xl font-bold text-green-700"},tt={class:"bg-white border-2 border-green-500 rounded-2xl shadow p-6 text-center"},st={class:"text-3xl font-bold text-green-700"},lt={__name:"Dashboard",setup(R){const f=g({totalUsers:0,totalSections:0,totalTests:0,totalAnswers:0});async function b(){try{const i=await D.get("/api/admin/stats");f.value={totalUsers:i.data.users,totalSections:i.data.questions,totalTests:i.data.tests,totalAnswers:i.data.answers}}catch(i){console.error("❌ Failed to fetch stats",i)}}return O(b),(i,x)=>(n(),o("div",Ze,[x[4]||(x[4]=e("h2",{class:"text-2xl font-bold flex items-center gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-6h13M3 7h13v6H3z"})]),v(" Dashboard Statistics ")],-1)),e("div",Ge,[e("div",We,[x[0]||(x[0]=e("p",{class:"text-sm text-gray-500"},"Total Users",-1)),e("h3",Je,C(f.value.totalUsers),1)]),e("div",Ke,[x[1]||(x[1]=e("p",{class:"text-sm text-gray-500"},"Total Questions",-1)),e("h3",Xe,C(f.value.totalSections),1)]),e("div",Ye,[x[2]||(x[2]=e("p",{class:"text-sm text-gray-500"},"Total Tests",-1)),e("h3",et,C(f.value.totalTests),1)]),e("div",tt,[x[3]||(x[3]=e("p",{class:"text-sm text-gray-500"},"Total Answers",-1)),e("h3",st,C(f.value.totalAnswers),1)])])]))}},ot={class:"flex justify-between items-center"},nt={class:"flex items-center gap-4"},rt=["value"],at={key:1,class:"bg-white p-6 border border-green-300 rounded-lg shadow space-y-6"},dt=["value"],it={class:"space-y-3"},ut=["onUpdate:modelValue"],ct={class:"flex items-center gap-1 text-sm text-green-700"},pt=["checked","onChange"],vt=["onClick"],gt={class:"text-right"},xt={class:"space-y-4"},mt={class:"flex justify-between items-start flex-wrap md:flex-nowrap"},ht={class:"space-y-1 w-full md:w-auto"},ft={class:"text-lg font-semibold"},bt={class:"text-sm"},yt={class:"font-semibold"},wt={class:"list-disc pl-6 text-sm"},_t={class:"flex gap-2 flex-wrap mt-4 md:mt-0"},kt=["onClick"],$t=["onClick"],Ct={key:0,class:"bg-green-50 border border-green-400 rounded-lg p-6 space-y-4"},Mt=["value"],Ut={class:"space-y-2"},St=["onUpdate:modelValue"],At={class:"flex items-center gap-1 text-sm"},Tt=["checked","onChange"],Dt=["onClick"],Ft={class:"text-right"},Vt={class:"bg-white rounded-lg p-6 shadow-lg w-full max-w-md space-y-4"},qt={class:"flex justify-end gap-3"},jt={__name:"Questions",setup(R){const f=g(null),b=g(null);let i=null;const x=g([]),k=g([]),_=g(""),p=g(!1),M=g(null),A=g(null),a=g(null),y=g("success"),t=g({question_text:"",test_id:"",answers:[{id:Date.now(),answer_text:"",is_correct:!1},{id:Date.now()+1,answer_text:"",is_correct:!1}]});let U=g(1),z=g(!1),w=g(!0);const d=async()=>{const h=await D.get("/api/admin/section");k.value=h.data},l=async()=>{if(!(z.value||!w.value)){z.value=!0;try{const h=await D.get("/api/admin/questions",{params:{page:U.value,test_id:_.value||void 0}});h.data.data.length===0?w.value=!1:(x.value.push(...h.data.data),U.value++)}catch(h){console.error(h)}finally{z.value=!1}}},u=()=>{x.value=[],U.value=1,w.value=!0,l()},$=()=>{i&&i.disconnect(),i=new IntersectionObserver(h=>{h[0].isIntersecting&&l()},{root:f.value,threshold:1}),b.value&&i.observe(b.value)};O(()=>{d(),l(),$()}),ye(()=>{i&&b.value&&i.unobserve(b.value)});const Q=async()=>{try{const h=await D.post("/api/admin/questions",t.value);x.value.unshift(h.data),N("✅ Question added successfully"),Y()}catch{N("❌ Failed to add question","error")}},E=async()=>{try{const h=await D.put(`/api/admin/questions/${M.value}`,t.value),s=x.value.findIndex(m=>m.id===M.value);s!==-1&&(x.value[s]=h.data),N("✅ Question updated"),Y()}catch{N("❌ Failed to update question","error")}},I=async()=>{try{await D.delete(`/api/admin/questions/${A.value.id}`),x.value=x.value.filter(h=>h.id!==A.value.id),N("✅ Question deleted"),A.value=null}catch{N("❌ Failed to delete question","error")}},ve=async()=>{if(confirm("Are you sure? This cannot be undone."))try{await D.delete("/api/admin/questions"),x.value=[],N("✅ All questions deleted")}catch{N("❌ Failed to delete all questions","error")}},ge=h=>{t.value={question_text:h.question_text,test_id:h.test_id,answers:h.answers.map(s=>({id:Date.now()+Math.random(),answer_text:s.answer_text,is_correct:s.is_correct}))},M.value=h.id,p.value=!1},xe=()=>{p.value=!p.value,p.value||Y()},se=h=>{t.value.answers.forEach((s,m)=>s.is_correct=m===h)},le=()=>{t.value.answers.push({id:Date.now()+Math.random(),answer_text:"",is_correct:!1})},oe=h=>{t.value.answers.splice(h,1)},me=h=>{A.value=h},N=(h,s="success")=>{a.value=h,y.value=s,setTimeout(()=>a.value=null,4e3)},Y=()=>{t.value={question_text:"",test_id:"",answers:[{id:Date.now(),answer_text:"",is_correct:!1},{id:Date.now()+1,answer_text:"",is_correct:!1}]},M.value=null,p.value=!1},he=h=>{const s=k.value.find(m=>m.id===h);return s?s.title:"Unknown"};return(h,s)=>(n(),o("div",{class:"max-w-6xl mx-auto p-6 space-y-8 relative",ref_key:"scrollContainer",ref:f},[e("div",ot,[s[9]||(s[9]=e("h2",{class:"text-2xl font-bold text-green-700"},"📋 Manage Questions",-1)),e("button",{onClick:xe,class:"bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 transition"},[r(c(X),{class:"inline w-4 h-4 mr-1"}),s[8]||(s[8]=v(" Add New Question "))])]),a.value?(n(),o("div",{key:0,class:W([y.value==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700","px-4 py-3 rounded"])},C(a.value),3)):F("",!0),e("div",nt,[S(e("select",{"onUpdate:modelValue":s[0]||(s[0]=m=>_.value=m),onChange:s[1]||(s[1]=m=>u()),class:"border border-green-300 rounded px-3 py-2"},[s[10]||(s[10]=e("option",{value:""},"All Tests",-1)),(n(!0),o(q,null,H(k.value,m=>(n(),o("option",{key:m.id,value:m.id},C(m.title),9,rt))),128))],544),[[G,_.value]]),e("button",{onClick:ve,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"},[r(c(L),{class:"inline w-4 h-4 mr-1"}),s[11]||(s[11]=v(" Delete All "))])]),p.value?(n(),o("div",at,[s[16]||(s[16]=e("h2",{class:"text-xl font-semibold text-green-700"},"📝 New Question",-1)),S(e("input",{"onUpdate:modelValue":s[2]||(s[2]=m=>t.value.question_text=m),type:"text",class:"w-full border border-green-300 px-4 py-2 rounded",placeholder:"Enter question text"},null,512),[[V,t.value.question_text]]),S(e("select",{"onUpdate:modelValue":s[3]||(s[3]=m=>t.value.test_id=m),class:"w-full border border-green-300 px-4 py-2 rounded"},[s[12]||(s[12]=e("option",{value:""},"Select Test",-1)),(n(!0),o(q,null,H(k.value,m=>(n(),o("option",{key:m.id,value:m.id},C(m.title),9,dt))),128))],512),[[G,t.value.test_id]]),e("div",it,[(n(!0),o(q,null,H(t.value.answers,(m,T)=>(n(),o("div",{key:m.id,class:"flex items-center gap-2"},[S(e("input",{"onUpdate:modelValue":B=>m.answer_text=B,type:"text",class:"w-full border border-green-300 px-3 py-2 rounded",placeholder:"Answer option"},null,8,ut),[[V,m.answer_text]]),e("label",ct,[e("input",{type:"radio",checked:m.is_correct,onChange:B=>se(T)},null,40,pt),s[13]||(s[13]=v(" Correct "))]),e("button",{onClick:B=>oe(T),class:"text-red-500 hover:underline text-sm"},[r(c(L),{class:"inline w-4 h-4"})],8,vt)]))),128)),e("button",{onClick:le,class:"text-green-700 text-sm hover:underline"},[r(c(X),{class:"inline w-4 h-4 mr-1"}),s[14]||(s[14]=v(" Add Answer "))])]),e("div",gt,[e("button",{onClick:Q,class:"bg-green-700 text-white px-6 py-2 rounded hover:bg-green-800"},[r(c(J),{class:"inline w-4 h-4 mr-1"}),s[15]||(s[15]=v(" Save "))])])])):F("",!0),e("div",xt,[(n(!0),o(q,null,H(x.value,m=>(n(),o("div",{key:m.id,class:"bg-white border border-green-300 rounded-lg shadow-sm p-5 space-y-4"},[e("div",mt,[e("div",ht,[e("h3",ft,C(m.question_text),1),e("p",bt,[s[17]||(s[17]=v("Test: ")),e("span",yt,C(he(m.test_id)),1)]),e("ul",wt,[(n(!0),o(q,null,H(m.answers,(T,B)=>(n(),o("li",{key:B,class:W({"text-green-600 font-bold":T.is_correct})},C(T.answer_text),3))),128))])]),e("div",_t,[e("button",{onClick:T=>ge(m),class:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 flex items-center gap-1"},[r(c(te),{class:"w-4 h-4"}),s[18]||(s[18]=v(" Edit "))],8,kt),e("button",{onClick:T=>me(m),class:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 flex items-center gap-1"},[r(c(L),{class:"w-4 h-4"}),s[19]||(s[19]=v(" Delete "))],8,$t)])]),M.value===m.id?(n(),o("div",Ct,[s[24]||(s[24]=e("h3",{class:"text-lg font-semibold text-green-700"},"✏️ Edit Question",-1)),S(e("input",{"onUpdate:modelValue":s[4]||(s[4]=T=>t.value.question_text=T),type:"text",placeholder:"Question text",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,t.value.question_text]]),S(e("select",{"onUpdate:modelValue":s[5]||(s[5]=T=>t.value.test_id=T),class:"w-full border border-green-300 rounded px-4 py-2"},[s[20]||(s[20]=e("option",{value:""},"Select Test",-1)),(n(!0),o(q,null,H(k.value,T=>(n(),o("option",{key:T.id,value:T.id},C(T.title),9,Mt))),128))],512),[[G,t.value.test_id]]),e("div",Ut,[(n(!0),o(q,null,H(t.value.answers,(T,B)=>(n(),o("div",{key:T.id,class:"flex items-center gap-2"},[S(e("input",{"onUpdate:modelValue":ee=>T.answer_text=ee,type:"text",class:"w-full border border-green-300 rounded px-3 py-2",placeholder:"Answer option"},null,8,St),[[V,T.answer_text]]),e("label",At,[e("input",{type:"radio",checked:T.is_correct,onChange:ee=>se(B)},null,40,Tt),s[21]||(s[21]=v(" Correct "))]),e("button",{onClick:ee=>oe(B),class:"text-red-600 hover:underline text-sm"},[r(c(L),{class:"inline w-4 h-4"})],8,Dt)]))),128)),e("button",{onClick:le,class:"text-green-700 text-sm hover:underline"},[r(c(X),{class:"inline w-4 h-4 mr-1"}),s[22]||(s[22]=v(" Add Answer "))])]),e("div",Ft,[e("button",{onClick:E,class:"bg-green-700 text-white px-6 py-2 rounded hover:bg-green-800"},[r(c(J),{class:"inline w-4 h-4 mr-1"}),s[23]||(s[23]=v(" Save "))])])])):F("",!0)]))),128))]),c(w)?(n(),o("div",{key:2,ref_key:"loadMoreRef",ref:b,class:"text-center text-gray-500 py-4"}," ⏳ Loading more questions... ",512)):F("",!0),A.value?(n(),o("div",{key:3,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",onClick:s[7]||(s[7]=K(m=>A.value=null,["self"]))},[e("div",Vt,[s[26]||(s[26]=e("h2",{class:"text-lg font-bold text-red-600"},"Delete Question?",-1)),s[27]||(s[27]=e("p",{class:"text-green-800 text-sm"},"Are you sure you want to delete this question?",-1)),e("div",qt,[e("button",{onClick:s[6]||(s[6]=m=>A.value=null),class:"bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300"},"Cancel"),e("button",{onClick:I,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"},[r(c(L),{class:"inline w-4 h-4 mr-1"}),s[25]||(s[25]=v(" Confirm Delete "))])])])])):F("",!0)],512))}},Qt={class:"max-w-6xl mx-auto p-6 space-y-8"},Et={class:"flex justify-between items-center"},Ht={key:0,class:"bg-white border border-green-300 rounded-lg p-6 space-y-4"},Rt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},zt={class:"text-right"},It={class:"space-y-4"},Nt={class:"flex flex-col md:flex-row justify-between md:items-center w-full"},Bt={class:"flex-1 space-y-1"},Lt={class:"text-lg font-semibold"},Ot={class:"text-sm"},Pt={class:"text-xs text-gray-500"},Zt={class:"flex gap-2 flex-wrap items-center mt-2 md:mt-0"},Gt=["onClick"],Wt=["onClick"],Jt={key:0,class:"border border-green-300 bg-white p-4 rounded-lg space-y-4"},Kt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Xt={class:"text-right"},Yt={key:2,class:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",style:{"backdrop-filter":"blur(2px)"}},es={class:"bg-white rounded-lg p-6 shadow-lg w-full max-w-md space-y-4"},ts={class:"flex justify-end gap-3"},ss={__name:"Sections",setup(R){const f=g([]),b=g(!1),i=g(null),x=g("success"),k=g(null),_=g(null),p=g({title:"",description:"",duration:30});function M(){b.value=!b.value,b.value||A()}function A(){p.value={title:"",description:"",duration:30},_.value=null}async function a(){try{const l=await D.get("/api/admin/section");f.value=l.data}catch{d("❌ Failed to load sections","error")}}async function y(){try{const l=await D.post("/api/admin/section",p.value);f.value.push(l.data),d("✅ Section added successfully","success"),A(),b.value=!1}catch{d("❌ Failed to add section","error")}}function t(l){_.value={...l},p.value={...l},b.value=!1}async function U(){try{const l=await D.put(`/api/admin/section/${_.value.id}`,p.value),u=f.value.findIndex($=>$.id===_.value.id);u!==-1&&(f.value[u]=l.data),d("✅ Section updated successfully","success"),A()}catch{d("❌ Failed to update section","error")}}function z(l){k.value=l}async function w(){try{await D.delete(`/api/admin/section/${k.value.id}`),f.value=f.value.filter(l=>l.id!==k.value.id),d("✅ Section deleted","error"),k.value=null}catch{d("❌ Failed to delete section","error")}}function d(l,u="success"){i.value=l,x.value=u,setTimeout(()=>i.value=null,4e3)}return O(a),(l,u)=>(n(),o("div",Qt,[e("div",Et,[u[7]||(u[7]=e("h2",{class:"text-2xl font-bold text-green-700"},"🗂️ Manage Sections",-1)),e("button",{onClick:M,class:"bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 transition"},[r(c(X),{class:"inline w-4 h-4 mr-1"}),v(" "+C(_.value?"Update Section":"Add New Section"),1)])]),b.value&&!_.value?(n(),o("div",Ht,[e("div",Rt,[S(e("input",{"onUpdate:modelValue":u[0]||(u[0]=$=>p.value.title=$),type:"text",placeholder:"Section Title",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,p.value.title]]),S(e("input",{"onUpdate:modelValue":u[1]||(u[1]=$=>p.value.duration=$),type:"number",placeholder:"Duration (minutes)",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,p.value.duration,void 0,{number:!0}]]),S(e("input",{"onUpdate:modelValue":u[2]||(u[2]=$=>p.value.description=$),type:"text",placeholder:"Short Description",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,p.value.description]])]),e("div",zt,[e("button",{onClick:y,class:"bg-green-700 text-white font-semibold px-6 py-2 rounded hover:bg-green-800 transition"},[r(c(J),{class:"inline w-4 h-4 mr-1"}),u[8]||(u[8]=v(" Save Section "))])])])):F("",!0),i.value?(n(),o("div",{key:1,class:W([x.value==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700","px-4 py-3 rounded"])},C(i.value),3)):F("",!0),e("div",It,[(n(!0),o(q,null,H(f.value,$=>{var Q,E;return n(),o("div",{key:$.id,class:W([((Q=_.value)==null?void 0:Q.id)===$.id?"bg-green-50 border-green-500":"bg-white border-green-300","border rounded-lg shadow-sm p-5 flex flex-col gap-4"])},[e("div",Nt,[e("div",Bt,[e("h3",Lt,C($.title),1),e("p",Ot,C($.description),1),e("p",Pt,"Duration: "+C($.duration)+" mins",1)]),e("div",Zt,[e("button",{onClick:I=>t($),class:"bg-green-600 text-white px-4 py-1 rounded hover:bg-green-700 flex items-center gap-1"},[r(c(te),{class:"w-4 h-4"}),u[9]||(u[9]=v(" Edit "))],8,Gt),e("button",{onClick:I=>z($),class:"bg-red-600 text-white px-4 py-1 rounded hover:bg-red-700 flex items-center gap-1"},[r(c(L),{class:"w-4 h-4"}),u[10]||(u[10]=v(" Delete "))],8,Wt)])]),((E=_.value)==null?void 0:E.id)===$.id?(n(),o("div",Jt,[e("div",Kt,[S(e("input",{"onUpdate:modelValue":u[3]||(u[3]=I=>p.value.title=I),type:"text",placeholder:"Section Title",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,p.value.title]]),S(e("input",{"onUpdate:modelValue":u[4]||(u[4]=I=>p.value.duration=I),type:"number",placeholder:"Duration (minutes)",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,p.value.duration,void 0,{number:!0}]]),S(e("input",{"onUpdate:modelValue":u[5]||(u[5]=I=>p.value.description=I),type:"text",placeholder:"Short Description",class:"w-full border border-green-300 rounded px-4 py-2"},null,512),[[V,p.value.description]])]),e("div",Xt,[e("button",{onClick:U,class:"bg-green-700 hover:bg-green-800 text-white px-6 py-2 rounded flex items-center gap-1"},[r(c(te),{class:"w-4 h-4"}),u[11]||(u[11]=v(" Update Section "))])])])):F("",!0)],2)}),128))]),k.value?(n(),o("div",Yt,[e("div",es,[u[13]||(u[13]=e("h2",{class:"text-lg font-bold text-red-600"},"Delete Section?",-1)),u[14]||(u[14]=e("p",{class:"text-gray-700"},"This action cannot be undone. Are you sure you want to delete this section?",-1)),e("div",ts,[e("button",{onClick:u[6]||(u[6]=$=>k.value=null),class:"bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300"}," Cancel "),e("button",{onClick:w,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center gap-1"},[r(c(L),{class:"inline w-4 h-4 mr-1"}),u[12]||(u[12]=v(" Confirm Delete "))])])])])):F("",!0)]))}},ls={class:"max-w-6xl mx-auto p-6 space-y-8 text-green-700"},os={class:"flex justify-between items-center"},ns={key:0,class:"bg-white border rounded-lg shadow-sm p-6 space-y-4"},rs={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded space-y-1"},as={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ds=["value"],is={class:"space-y-6"},us={class:"flex flex-col md:flex-row justify-between md:items-center space-y-2 md:space-y-0"},cs={class:"flex-1 space-y-1"},ps={class:"text-lg font-semibold text-gray-800"},vs={class:"text-sm text-gray-600"},gs={class:"text-xs text-gray-500"},xs={class:"inline-block px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded"},ms={key:0,class:"flex gap-2 flex-wrap items-center"},hs=["onUpdate:modelValue","onChange"],fs=["value"],bs=["onClick"],ys={key:1,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},ws={class:"bg-white rounded-lg p-6 w-full max-w-md space-y-4"},_s={class:"flex justify-end gap-3"},ks={__name:"Users",setup(R){const{user:f}=ue(),b=["admin","super-admin"].some(w=>{var d,l;return(l=(d=f.value)==null?void 0:d.roles)==null?void 0:l.includes(w)}),i=g([]),x=g([]),k=g(!1),_=g(null),p=g([]),M=g({name:"",email:"",password:"",role:""});async function A(){try{const w=await D.get("api/admin/users");i.value=w.data.data||[]}catch(w){console.error("Failed to fetch users",w)}}async function a(){try{const w=await D.get("api/admin/roles");x.value=w.data.roles||[]}catch(w){console.error("Failed to fetch roles",w)}}async function y(){var $;p.value=[];const{name:w,email:d,password:l,role:u}=M.value;if(!w||!d||!l||!u){p.value.push("All fields are required.");return}try{const Q=await D.post("api/admin/users",{name:w,email:d,password:l,role:u});i.value.push(Q.data.user),M.value={name:"",email:"",password:"",role:""},k.value=!1}catch(Q){(($=Q.response)==null?void 0:$.status)===422?p.value=Object.values(Q.response.data.errors).flat():p.value=["Failed to add user."]}}async function t(w){try{const d=await D.post(`api/admin/users/${w.id}/update-role`,{role:w.role});w.roles=d.data.user.roles}catch(d){console.error("Failed to update role",d)}}function U(w){_.value=w}async function z(){try{await D.delete(`api/admin/users/${_.value.id}`),i.value=i.value.filter(w=>w.id!==_.value.id),_.value=null}catch(w){console.error("Failed to delete user",w)}}return O(async()=>{await a(),await A()}),(w,d)=>(n(),o("div",ls,[e("div",os,[d[6]||(d[6]=e("h2",{class:"text-2xl font-bold"},"👥 Users Management",-1)),c(b)?(n(),o("button",{key:0,onClick:d[0]||(d[0]=l=>k.value=!k.value),class:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition"},C(k.value?"❌ Hide Form":"➕ Add User"),1)):F("",!0)]),k.value?(n(),o("div",ns,[d[8]||(d[8]=e("h2",{class:"text-xl font-bold text-gray-800"},"Add New User",-1)),p.value.length?(n(),o("div",rs,[(n(!0),o(q,null,H(p.value,(l,u)=>(n(),o("div",{key:u,class:"text-sm"},C(l),1))),128))])):F("",!0),e("div",as,[S(e("input",{"onUpdate:modelValue":d[1]||(d[1]=l=>M.value.name=l),type:"text",class:"w-full border px-4 py-2 rounded",placeholder:"Name"},null,512),[[V,M.value.name]]),S(e("input",{"onUpdate:modelValue":d[2]||(d[2]=l=>M.value.email=l),type:"email",class:"w-full border px-4 py-2 rounded",placeholder:"Email"},null,512),[[V,M.value.email]]),S(e("input",{"onUpdate:modelValue":d[3]||(d[3]=l=>M.value.password=l),type:"password",class:"w-full border px-4 py-2 rounded",placeholder:"Password"},null,512),[[V,M.value.password]]),S(e("select",{"onUpdate:modelValue":d[4]||(d[4]=l=>M.value.role=l),class:"w-full border px-4 py-2 rounded"},[d[7]||(d[7]=e("option",{value:""},"Select Role",-1)),(n(!0),o(q,null,H(x.value,l=>(n(),o("option",{key:l,value:l},C(l),9,ds))),128))],512),[[G,M.value.role]])]),e("div",{class:"text-right"},[e("button",{onClick:y,class:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition"}," Save User ")])])):F("",!0),e("div",is,[(n(!0),o(q,null,H(i.value,(l,u)=>{var $,Q;return n(),o("div",{key:u,class:"bg-white border rounded-lg shadow-sm p-5 space-y-4"},[e("div",us,[e("div",cs,[e("h3",ps,C(l.name),1),e("p",vs,C(l.email),1),e("p",gs,[d[9]||(d[9]=v(" Role: ")),e("span",xs,C(((Q=($=l.roles)==null?void 0:$[0])==null?void 0:Q.name)||"None"),1)])]),c(b)?(n(),o("div",ms,[S(e("select",{"onUpdate:modelValue":E=>l.role=E,onChange:E=>t(l),class:"border px-3 py-1 rounded"},[d[10]||(d[10]=e("option",{value:""},"Change Role",-1)),(n(!0),o(q,null,H(x.value,E=>(n(),o("option",{key:E,value:E},C(E),9,fs))),128))],40,hs),[[G,l.role]]),e("button",{onClick:E=>U(l),class:"bg-red-600 text-white px-4 py-1 rounded hover:bg-red-700 transition"}," Delete ",8,bs)])):F("",!0)])])}),128))]),_.value?(n(),o("div",ys,[e("div",ws,[d[11]||(d[11]=e("h2",{class:"text-lg font-bold text-red-600"},"Delete User?",-1)),d[12]||(d[12]=e("p",{class:"text-gray-700"},"This action is permanent.",-1)),e("div",_s,[e("button",{onClick:d[5]||(d[5]=l=>_.value=null),class:"bg-gray-200 px-4 py-2 rounded"},"Cancel"),e("button",{onClick:z,class:"bg-red-600 text-white px-4 py-2 rounded"},"Confirm Delete")])])])):F("",!0)]))}},$s={class:"max-w-6xl mx-auto p-6 space-y-8 text-green-700"},Cs={class:"text-2xl font-bold flex items-center gap-2"},Ms={class:"bg-white border rounded-lg shadow p-6 space-y-6"},Us={class:"text-lg font-semibold flex items-center gap-2"},Ss={class:"text-right"},As={class:"bg-white border rounded-lg shadow p-6 space-y-4"},Ts={class:"text-lg font-semibold flex items-center gap-2"},Ds={class:"flex items-center justify-between"},Fs={class:"inline-flex items-center cursor-pointer"},Vs={class:"bg-white border rounded-lg shadow p-6 space-y-6"},qs={class:"text-lg font-semibold flex items-center gap-2"},js={class:"text-right"},Qs={class:"bg-white border border-red-500 rounded-lg shadow p-6 space-y-4"},Es={class:"text-lg font-semibold text-red-600 flex items-center gap-2"},Hs={class:"text-right"},Rs={__name:"Settings",setup(R){const f=g(""),b=g("success"),i=g({system_name:"",system_description:"",dark_mode_enabled:!1}),x=g(null);async function k(){const y=localStorage.getItem("auth_token");y&&(D.defaults.headers.common.Authorization=`Bearer ${y}`)}async function _(){var y;try{await D.post("api/settings",i.value),a("✅ Settings saved successfully","success")}catch(t){a("❌ Error saving settings","error"),console.error(((y=t.response)==null?void 0:y.data)||t.message)}}function p(y){x.value=y.target.files[0]}async function M(y){var U;if(!x.value)return a("Choose a file first","error");const t=new FormData;t.append("file",x.value);try{await D.post(`api/import/${y}`,t,{headers:{"Content-Type":"multipart/form-data"}}),a("✅ File uploaded successfully","success"),x.value=null}catch(z){a("❌ Upload failed","error"),console.error(((U=z.response)==null?void 0:U.data)||z.message)}}async function A(y){var t;if(confirm("Are you sure? This cannot be undone."))try{await D.delete(`api/delete/${y}`),a(`✅ All ${y} deleted successfully`,"success")}catch(U){a("❌ Delete failed","error"),console.error(((t=U.response)==null?void 0:t.data)||U.message)}}function a(y,t="success"){f.value=y,b.value=t,setTimeout(()=>f.value=null,4e3)}return O(k),(y,t)=>(n(),o("div",$s,[e("h2",Cs,[r(c(Z),{class:"w-6 h-6"}),t[5]||(t[5]=v(" System Settings "))]),f.value?(n(),o("div",{key:0,class:W([b.value==="success"?"bg-green-100 border-green-400 text-green-700":"bg-red-100 border-red-400 text-red-700","border px-4 py-3 rounded transition"])},C(f.value),3)):F("",!0),e("div",Ms,[e("h3",Us,[r(c(ce),{class:"w-5 h-5"}),t[6]||(t[6]=v(" System Info "))]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium mb-1"},"System Name",-1)),S(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=U=>i.value.system_name=U),placeholder:"Enter system name",class:"w-full border px-3 py-2 rounded"},null,512),[[V,i.value.system_name]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium mb-1"},"System Description",-1)),S(e("textarea",{rows:"3","onUpdate:modelValue":t[1]||(t[1]=U=>i.value.system_description=U),placeholder:"Enter system description",class:"w-full border px-3 py-2 rounded"},null,512),[[V,i.value.system_description]])]),e("div",Ss,[e("button",{onClick:_,class:"bg-green-700 text-white px-5 py-2 rounded hover:bg-green-800 transition flex items-center gap-2"},[r(c(Se),{class:"w-4 h-4"}),t[9]||(t[9]=v(" Save Settings "))])])]),e("div",As,[e("h3",Ts,[r(c(Ue),{class:"w-5 h-5"}),t[10]||(t[10]=v(" Dark Mode "))]),e("div",Ds,[t[12]||(t[12]=e("span",null," Enable or disable dark mode for all users ",-1)),e("label",Fs,[S(e("input",{type:"checkbox",class:"sr-only peer","onUpdate:modelValue":t[2]||(t[2]=U=>i.value.dark_mode_enabled=U)},null,512),[[we,i.value.dark_mode_enabled]]),t[11]||(t[11]=e("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer-checked:bg-green-600 relative"},[e("span",{class:"absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition peer-checked:translate-x-5"})],-1))])])]),e("div",Vs,[e("h3",qs,[r(c(Te),{class:"w-5 h-5"}),t[13]||(t[13]=v(" Import Questions "))]),e("div",null,[e("input",{type:"file",onChange:p,accept:".csv,.xlsx",class:"w-full border px-3 py-2 rounded"},null,32)]),e("div",js,[e("button",{onClick:t[3]||(t[3]=U=>M("questions")),class:"bg-green-700 text-white px-5 py-2 rounded hover:bg-green-800 transition flex items-center gap-2"},[r(c(Ce),{class:"w-4 h-4"}),t[14]||(t[14]=v(" Upload & Import "))])])]),e("div",Qs,[e("h3",Es,[r(c(Ae),{class:"w-5 h-5"}),t[15]||(t[15]=v(" Delete All Questions "))]),t[17]||(t[17]=e("p",{class:"text-sm"}," This will permanently delete all questions. This action cannot be undone. ",-1)),e("div",Hs,[e("button",{onClick:t[4]||(t[4]=U=>A("questions")),class:"bg-red-600 text-white px-5 py-2 rounded hover:bg-red-700 transition flex items-center gap-2"},[r(c(L),{class:"w-4 h-4"}),t[16]||(t[16]=v(" Delete All "))])])])]))}},zs=[{path:"/admin/dashboard",name:"DashboardHome",component:lt,meta:{requiresAuth:!0}},{path:"/admin/dashboard/questions",name:"Questions",component:jt,meta:{requiresAuth:!0,roles:["super-admin","student"]}},{path:"/admin/dashboard/sections",name:"Sections",component:ss,meta:{requiresAuth:!0,roles:["super-admin","student"]}},{path:"/admin/dashboard/users",name:"Users",component:ks,meta:{requiresAuth:!0,roles:["super-admin","student"]}},{path:"/admin/dashboard/settings",name:"Settings",component:Rs,meta:{requiresAuth:!0,roles:["super-admin","student"]}}],pe=ke({history:$e(),routes:zs});pe.beforeEach(async(R,f,b)=>{const{token:i,user:x,init:k,hasAnyRole:_}=ue();if(i.value&&!x.value&&await k(),R.meta.requiresAuth){if(!i.value)return b("/login");if(R.meta.roles&&!_(R.meta.roles))return b("/")}b()});_e(Pe).use(pe).mount("#app");
